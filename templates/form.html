<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cr√©ateur de CV</title>
    <link rel="stylesheet" href="/static/styles.css">
    <style>
        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #00ffae;
            color: #000;
            border: none;
            padding: 15px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            font-size: 20px;
            transition: background-color 0.3s ease-in-out;
        }

        .floating-btn:hover {
            background-color: #00e29e;
        }

        .floating-btn input[type="file"] {
            display: none;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .btn-format {
            background-color: #00ffae;
            color: #000;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 255, 170, 0.3);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .btn-format:hover {
            background-color: #00e29e;
            transform: scale(1.05);
        }

        .btn-format.pdf {
            background-color: #ffae00;
        }

        .btn-format.pdf:hover {
            background-color: #e29e00;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Cr√©ation de CV ‚Äì Emma√ºs-Brie</h2>
        <form id="cv-form" action="/generate" method="post" enctype="multipart/form-data">
            <label for="nom">Nom :</label>
            <input type="text" id="nom" name="nom" required>

            <label for="age">√Çge :</label>
            <input type="text" id="age" name="age" required>

            <label for="titre">Titre :</label>
            <input type="text" id="titre" name="titre">

            <label for="ville">Ville :</label>
            <input type="text" id="ville" name="ville">

            <label for="email">Email :</label>
            <input type="email" id="email" name="email">

            <label for="telephone">T√©l√©phone :</label>
            <input type="text" id="telephone" name="telephone">

            <label for="profil">Profil :</label>
            <textarea id="profil" name="profil" rows="4" placeholder="D√©crivez votre parcours, vos objectifs..."></textarea>

            <label for="experiences">Exp√©riences :</label>
            <textarea id="experiences" name="experiences" rows="5" placeholder="Ex : Vendeur ‚Äì Emma√ºs-Brie ‚Äì 2023-2024&#10;‚Ä¢ Conseil client&#10;‚Ä¢ Mise en rayon..."></textarea>

            <label for="competences">Comp√©tences :</label>
            <textarea id="competences" name="competences" rows="3" placeholder="S√©parez par des virgules (ex : Accueil, Bureautique, √âlectronique...)"></textarea>

            <label for="langues">Langues :</label>
            <textarea id="langues" name="langues" rows="2" placeholder="Fran√ßais (courant), Anglais (B1)..."></textarea>

            <label for="formations">Formations :</label>
            <textarea id="formations" name="formations" rows="3" placeholder="Ex : 2022 ‚Äì Bac Pro Vente ‚Äì Lyc√©e Flora Tristan"></textarea>

            <label for="interets">Centres d'int√©r√™t :</label>
            <textarea id="interets" name="interets" rows="2" placeholder="Ex : Sport, R√©seaux sociaux, Musique..."></textarea>

            <label class="checkbox-label">
                <input type="checkbox" id="consentement" name="consentement" required>
                <span>J'accepte que mes donn√©es soient utilis√©es pour g√©n√©rer mon CV.</span>
            </label>

            <label for="photo">Photo de profil :</label>
            <input type="file" id="photo" name="photo" accept="image/*">

            <button type="button" onclick="genererApercu()">Aper√ßu du CV</button>
            
            <div class="btn-container">
                <button class="btn-format" type="submit" name="format" value="docx">T√©l√©charger en Word (.docx)</button>
                <button class="btn-format pdf" type="submit" name="format" value="pdf">T√©l√©charger en PDF</button>
            </div>
            
            <div id="cv-preview">
                <h2 id="preview-nom"></h2>
                <p id="preview-titre"></p>
                <p id="preview-coordonnees"></p>
                <h3>Profil</h3>
                <p id="preview-profil"></p>
                <h3>Exp√©riences</h3>
                <ul id="preview-experiences"></ul>
                <h3>Comp√©tences</h3>
                <ul id="preview-competences"></ul>
                <h3>Langues</h3>
                <ul id="preview-langues"></ul>
                <h3>Formation</h3>
                <ul id="preview-formations"></ul>
                <h3>Centres d'int√©r√™t</h3>
                <ul id="preview-interets"></ul>
            </div>
        </form>
    </div>

    <!-- Floating button for uploading a photo -->
    <label class="floating-btn" for="photo">
        üì∑
        <input type="file" id="photo" name="photo" accept="image/*">
    </label>

    <script>
        function genererApercu() {
            // V√©rifier le consentement
            if (!document.getElementById('consentement').checked) {
                alert("Veuillez accepter les conditions d'utilisation");
                return;
            }

            document.getElementById("cv-preview").style.display = "block";

            // Nom et √¢ge
            const nom = document.getElementById('nom').value;
            const age = document.getElementById('age').value;
            document.getElementById("preview-nom").textContent = nom + (age ? ` ‚Äì ${age} ans` : '');

            // Titre
            document.getElementById("preview-titre").textContent = document.getElementById('titre').value;

            // Coordonn√©es
            const ville = document.getElementById('ville').value;
            const email = document.getElementById('email').value;
            const telephone = document.getElementById('telephone').value;
            
            let coordonnees = [];
            if (ville) coordonnees.push(`üìç ${ville}`);
            if (email) coordonnees.push(`üìß ${email}`);
            if (telephone) coordonnees.push(`üìû ${telephone}`);
            
            document.getElementById("preview-coordonnees").innerHTML = coordonnees.join('<br>');

            // Profil
            document.getElementById("preview-profil").textContent = document.getElementById('profil').value;

            // Remplir les listes
            remplirListe("experiences", "preview-experiences", '\n');
            remplirListe("competences", "preview-competences", ',');
            remplirListe("langues", "preview-langues", ',');
            remplirListe("formations", "preview-formations", '\n');
            remplirListe("interets", "preview-interets", ',');
        }

        function remplirListe(champ, cible, separateur) {
            const ul = document.getElementById(cible);
            ul.innerHTML = "";
            const texte = document.getElementById(champ).value;
            
            if (!texte.trim()) return;
            
            const elements = texte.split(separateur)
                                 .filter(el => el.trim())
                                 .map(el => el.trim());
            
            elements.forEach(el => {
                const li = document.createElement("li");
                li.textContent = el;
                ul.appendChild(li);
            });
        }
    </script>
</body>
</html>